service: core

custom:
  settings:
    searchTable: ServiceProvider
    userTable: UserT
    algoliaAppId: ${ssm:notes-api/algolia/app-id}
    algoliaAdminApiKey: ${ssm:notes-api/algolia/api-key}
    algoliaIndexName: service_provider

package:
  individually: true

plugins:
  - serverless-bundle
  - serverless-offline
  - serverless-dotenv-plugin

provider:
  name: aws
  runtime: nodejs12.x
  stackName: eugostitelji-core-stack
  apiName: eugostitelji-api
  stage: dev
  region: us-east-1
  lambdaHashingVersion: "20201221"

  environment:
    tableName: ${env:TABLE_NAME}

#   iamRoleStatements:
#     - Effect: Allow
#       Action:
#         - dynamodb:Scan
#         - dynamodb:Query
#         - dynamodb:GetItem
#         - dynamodb:PutItem
#         - dynamodb:UpdateItem
#         - dynamodb:DeleteItem
#         - dynamodb:DescribeTable
#       Resource: "arn:aws:dynamodb:us-east-1:*:*"

# functions:
#   algoliaSync:
#     # Syncs ServiceProvider table to algolia service
#     handler: algoliaSync.main
#     events:
#       - stream:
#           type: dynamodb
#           arn: !GetAtt ServiceProvider.StreamArn

#   create:
#     handler: create.main
#     events:
#       - http:
#           path: places
#           method: post
#   get:
#     handler: get.main
#     events:
#       - http:
#           path: places/{id}
#           method: get
#   list:
#     handler: list.main
#     events:
#       - http:
#           path: places
#           method: get
#   update:
#     handler: update.main
#     events:
#       - http:
#           path: places/{id}
#           method: put
#   delete:
#     handler: delete.main
#     events:
#       - http:
#           path: places/{id}
#           method: delete

resources:
  - ${file(resources/cognito.yml)}
  - ${file(resources/dynamodb.yml)}
